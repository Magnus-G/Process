@function master-color($bg-color, $percentage: 100) {
  $mix-color: orange; // Color to mix into $bg-color if "mix" is used.
  $mix-weight: 93%; // Percetage of main color compared to mix-color.
  $color-lightness: lightness($bg-color); // The lightness value (0-100) for $bg-color.
  $color-darkness: 100 - $color-lightness; // The darkness value (0-100) for $bg-color.
 
  $effect-color: $bg-color;

  $effect-color: grayscale($effect-color);
  $effect-color: mix($effect-color, $mix-color, $mix-weight);
  $effect-color: adjust-hue($effect-color, -20);
  // $effect-color: darken($effect-color, 40); 
  $effect-color: desaturate($effect-color, 25);

  $bg-color: mix($effect-color, $bg-color, $percentage);

  @return $bg-color;
} 
 
@mixin master-color-invert-text($bg-color, $lightness-threshold: 50) {
// $lightness-threshold â€” Threshold for when a background is too light to have light text on it.
  $master-color: master-color($bg-color);
  background-color: $master-color; // Applies the effects to the background.
  $color: lighten($master-color, 70); // Makes the font-color lighter than the background by default.
  text-shadow: 0 1px 1px darken($master-color, 20); // Adds a shadow on light fonts.   

  @if lightness($master-color) > $lightness-threshold {
    $color: darken($master-color, 40); // Makes the font-color dark if background is lighter than the threshold. 
    text-shadow: 0 1px 1px lighten($master-color, 10); // Adds an inset highlight on dark fonts.  
  }
  color: $color; // Applies color to font.
}

//////////////////////////////////////////////////////////////////////////////

@mixin box-shadow {
  $shadow-color: master-color(black);
  box-shadow: 0px 1px 2px $shadow-color;
}

//////////////////////////////////////////////////////////////////////////////

$top-bar-color: master-color(#444);;
$background-color: master-color(#F0F2F5);
$section-color: master-color(#fbfbfb);
$ref-color: $top-bar-color;
$nav-color: master-color(#A7B3C5);
$images-example-color: master-color(#E1E1E1);
$image-border: master-color(white);

$font-color: master-color(#444);
$font-color-secondary: master-color(#393939);
$font-color-link: master-color(#3399cc, 10);
$font-intro-color: #C4B58E;
$font-color-title: master-color(white);

$font-size: 21px;

$contrast-color-1: #FF90B3;
$contrast-color-2: #59DFB9;
$contrast-color-3: #F35959;

$radius: 3px;
$space: 30px;
$indent: 1.6em;
$paragraph-end: 1.6em;
$section-end: 3.2em;

$heading: "Bigshot One", helvetica;
$slab: 'Roboto Slab', helvetica, serif;
$serif: "Crimson Text", georgia, serif;
$sans: "Open Sans", helvetica, sans-serif;


@import 'typography';
@import 'magnific';
@import 'patterns';
@import 'animations';

////////////////////////////////////////////////

body {
  margin: 0px;
  padding: 1px 0 20px 0px; // 1px for the pattern to work??
  background-color: $background-color;
  // @include pattern($background-color, black, 10);
}

.offset {
  margin-bottom: -25px;
}

.top-bar {
  // @include pattern($top-bar-color, darken($top-bar-color, 5), 4);
  background-color: $top-bar-color;
  position: fixed;
  top: 0;
  z-index: 99;
  width: 100%;
  ul {
    float: right;
    padding: 0.5em 0.5em 0.8em 0.5em;
    margin: 0;
    li {
      display: inline;
      padding: 0.5em;
      a {
        font-family: $slab;
        color: master-color(white);
        font-size: $font-size /1.6;
      }
    }
  }
}

a.invisible {
  cursor: pointer !important;
  float: right;
  width: 100%;
  height: 20px;
}

.ref {
  margin: 0 0 $section-end 0;
  @include pattern($ref-color, darken($ref-color, 5), 21);
  padding: 20px;

  h5 {
    color: white;
  }
  a {
    display: block;
    font-family: $slab;
    line-height: 1.5em;
    color: #71C4EE;
  }
}

.wrapper {
  width: 650px;
  margin: 0 auto;
  position: relative;
}

section {
  width: 650px;
  padding: 2.6em;
  margin: 20px 0;
  margin-top: 70px;
  position: relative;
  border-radius: 3px;
}

section img {
  max-width: 100%;
}

nav {
  width: 230px;
  position: fixed;
  top: 103px;
  left: 50%;
  margin-left: -580px;
  text-align: right;
}


.img-examples {
  margin-top: $indent /2;
  background-color: $images-example-color;
  padding: 14px 14px 0 14px;
  border-radius: 8px;
  margin-bottom: $paragraph-end;
}

.popup img {
  position: relative;
  border-radius: $radius;
  width: auto;
  margin-right: 0.6em;
  margin-bottom: 10px;

  // border: 3px solid $image-border;
  @include box-shadow;
  height: 90px;
}

//////////////////////////////////////////////////////////////////////////////////
//
//   Media
//
//////////////////////////////////////////////////////////////////////////////////

@media print, screen and (max-width: 1060px) {
  div.wrapper {
    width: auto;
    margin: 0;
  }

  nav {
    display: none;
  }

  header, section, footer {
    float: none;
  }
  header h1, section h1, footer h1 {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    -o-text-overflow: ellipsis;
    -ms-text-overflow: ellipsis;
  }

  #banner {
    width: 100%;
  }
  #banner .downloads {
    margin-right: 60px;
  }
  #banner #logo {
    margin-right: 15px;
  }

  section {
    border-width: 1px 0;
    padding: 20px auto;
    margin: 20px auto 20px;
    max-width: 600px;
  }

  footer {
    text-align: center;
    margin: 20px auto;
    position: relative;
    left: auto;
    bottom: auto;
    width: auto;
  }
}
@media print, screen and (max-width: 720px) {
  body {
    word-wrap: break-word;
  }

  header {
    padding: 20px 20px;
    margin: 0;
  }
  header h1 {
    font-size: 32px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    -o-text-overflow: ellipsis;
    -ms-text-overflow: ellipsis;
  }
  header p {
    display: none;
  }

  #banner {
    top: 80px;
  }

  .fork {
    float: right;
  }

  section {
    margin-top: 20px;
    margin-bottom: 0px;
    width: auto;
  }

  header ul, header p.view {
    position: static;
  }
}
@media print, screen and (max-width: 480px) {
  header {
    position: relative;
    padding: 5px 0px;
    min-height: 0px;
  }
  header h1 {
    font-size: 24px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    -o-text-overflow: ellipsis;
    -ms-text-overflow: ellipsis;
  }

  section {
    margin-top: 5px;
  }

  #banner {
    display: none;
  }

  header ul {
    display: none;
  }
}
@media print {
  body {
    padding: 0.4in;
    font-size: 12pt;
    color: #444;
  }
}
@media print, screen and (max-height: 680px) {
  footer {
    text-align: center;
    margin: 20px auto;
    position: relative;
    left: auto;
    bottom: auto;
    width: auto;
  }
}
@media print, screen and (max-height: 480px) {
  nav {
    display: none;
  }

  footer {
    text-align: center;
    margin: 20px auto;
    position: relative;
    left: auto;
    bottom: auto;
    width: auto;
  }
}
